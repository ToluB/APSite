<div id="<%= dom_id(post) %>">	 
	<div class="post" data-post-id="<%= post.id %>">
		
		<%= render 'users/user', :user => post.user %>
	
		<span class="title">
		<%=link_to post.title, post %><br>
	  </span>
	
		<%= render 'shared/merits', :merits => post.merits %>
	
		<span class="content">
	  <%= raw post.content %><br>
		</span>
	
		<span class="post_actions">
			<%= link_to "Reply", new_convo_post_path(:convo_id => post.convo.id, :parent_id => post.id), :remote => true %>
			</span><br>
	</div>
</div>

<script>

$('.upmerit').click(function(){
	meritDiv=$(this).siblings('.merits');
	var id = meritDiv.parent().data('post-id');
			var merits = parseInt(meritDiv.text());
		
		  merits += 1;
		
			$.ajax({
				url: "/posts/"+id,
				type: "POST",
				dataType: "json",
				data: { _method: "PUT", id: id, post: { merits: merits } }
			}).success(function(){
				meritDiv.text(merits);
			}).fail(function(data){
				alert("Sorry, request failed");
			});
});

$('.demerit').click(function(){
	meritDiv=$(this).siblings('.merits');
	var id = meritDiv.parent().data('post-id');
			var merits = parseInt(meritDiv.text());
		
		  merits -= 1;
		
			$.ajax({
				url: "/posts/"+id,
				type: "POST",
				dataType: "json",
				data: { _method: "PUT", id: id, post: { merits: merits } }
			}).success(function(){
				meritDiv.text(merits);
			}).fail(function(data){
				alert("Sorry, request failed");
			});
});

</script>
